LAYER
    NAME "{{view_name}}"
    {% if geotiff %}
    DATA "{{file_name}}"
    EXTENT  -55.0000000000000000 -21.0000000000000000 -42.9614372253417969 -8.9754829406738299
    METADATA
      "ows_title" "{{ows_title}}"
      "ows_abstract" "{{ows_abstract}}"
      "gml_exclude_items" "the_geom"
      "gml_include_items" "all"
      "gml_geometries"  "the_geom"
    END

    PROJECTION
      "init=epsg:4674"
    END
    STATUS ON
    TYPE Raster
    TEMPLATE "DUMMY"
    PROCESSING "RANGE_COLORSPACE=HSL"
    PROCESSING "KERNELDENSITY_RADIUS=20"
    PROCESSING "KERNELDENSITY_COMPUTE_BORDERS=ON"
    PROCESSING "KERNELDENSITY_NORMALIZATION=AUTO"
    OFFSITE 0 0 0
    {% else %}
    CONNECTIONTYPE POSTGIS
    CONNECTION "host={{host}} port={{port}} dbname={{dbname}} user={{user}} password={{password}}"
    DATA "geom from (select * from {{view_name}} where %MSFILTER% ) as subquery using unique gid using srid=4674"
    EXTENT  -55.0000000000000000 -21.0000000000000000 -42.9614372253417969 -8.9754829406738299
    PROCESSING "CLOSE_CONNECTION=DEFER"
    METADATA
      "ows_title" "{{ows_title}}"
      "ows_abstract" "{{ows_abstract}}"
      "gml_exclude_items" "geom"
      "gml_include_items" "all"
      "gml_geometries"  "geom"
    END
    PROJECTION
      "init=epsg:4674"
    END
    STATUS ON
    TYPE Point
    TEMPLATE "DUMMY"
    VALIDATION 
      "MSFILTER" "." 
      "DEFAULT_MSFILTER" "datetime = (select min(datetime) from {{table_name}})"
    END
    {% endif %}
    CLASS
{% for style in styles %}
      STYLE
        COLORRANGE '{{style['color0']}}ff' '{{style['color1']}}ff'
        DATARANGE {{style['mini']}} {{style['maxi']}}
      END
    {% endfor %}
    END
END

